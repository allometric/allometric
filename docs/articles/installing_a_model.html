<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="allometric">
<title>Installing a Model • allometric</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Installing a Model">
<meta property="og:description" content="allometric">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">allometric</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.9008</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/descriptors.html">Describing a Model with Descriptors</a>
    <a class="dropdown-item" href="../articles/installing_a_model.html">Installing a Model</a>
    <a class="dropdown-item" href="../articles/inventory_example.html">Common Inventory Use Cases</a>
    <a class="dropdown-item" href="../articles/mixed_effects.html">Mixed-Effects Models</a>
    <a class="dropdown-item" href="../articles/variable_naming_system.html">Variable Naming System</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/brycefrank/allometric/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Installing a Model</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/brycefrank/allometric/blob/HEAD/vignettes/installing_a_model.Rmd" class="external-link"><code>vignettes/installing_a_model.Rmd</code></a></small>
      <div class="d-none name"><code>installing_a_model.Rmd</code></div>
    </div>

    
    
<p>Models can be installed by anyone provided they are comfortable
writing R and submitting <code>git</code> pull requests. The model
installation process involves these basic steps.</p>
<ol style="list-style-type: decimal">
<li>Fork and then clone the <code>allometric</code> git repository to
your local enviroment.</li>
<li>Write a new file in the <code>inst/publications</code> directory
that
<ol style="list-style-type: lower-alpha">
<li>Establishes a citation for the originating publication of the
model.</li>
<li>Instantiates the model (usually a <code>ParametricModel</code> or
<code>ModelSet</code>) with associated metadata and prediction
function.</li>
</ol>
</li>
<li>Add and commit the new file to the remote forked repository from
(1)</li>
<li>Submit a pull request to <code>brycefrank/allometric</code> via
GitHub.</li>
</ol>
<p>After the completion of step 4, your pull request will be tested and
reviewed for completion, and will become part of the main package if it
passes review.</p>
<p>This vignette will focus on the second step. Explanation of
<code>git</code> pull requests are beyond the scope of this vignette,
but interested readers can learn using <a href="https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-pull-requests" class="external-link">About
Pull Requests</a>. Interested readers should also contact Bryce Frank
(<a href="mailto:bfrank70@gmail.com" class="email">bfrank70@gmail.com</a>), or open an issue on GitHub if
they want their models added but do not want to learn
<code>git</code>.</p>
<div class="section level2">
<h2 id="establishing-a-publication">Establishing a Publication<a class="anchor" aria-label="anchor" href="#establishing-a-publication"></a>
</h2>
<p><code><a href="../reference/Publication.html">allometric::Publication</a></code> is a class that represents a
given scientific article, report, or other technical document that
contains allometric models.</p>
<p>Citations are established using <code><a href="https://docs.ropensci.org/RefManageR/reference/BibEntry.html" class="external-link">RefManageR::BibEntry</a></code>
which is an R representation of a BibTex citation. For example, the
BibEntry for the following publication</p>
<p>H. Temesgen, V. J. Monleon, and D. W. Hann. “Analysis and comparison
of nonlinear tree height prediction strategies for Douglas-fir forests”.
In: <em>Canadian Journal of Forest Research</em> 38.3 (2008),
pp. 553-565.</p>
<p>is</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paper_citation</span> <span class="op">&lt;-</span> <span class="fu">RefManageR</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/RefManageR/reference/BibEntry.html" class="external-link">BibEntry</a></span><span class="op">(</span></span>
<span>  bibtype <span class="op">=</span> <span class="st">"article"</span>,</span>
<span>  key <span class="op">=</span> <span class="st">"temesgen_2008"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Analysis and comparison of nonlinear tree height prediction</span></span>
<span><span class="st">        strategies for Douglas-fir forests"</span>,</span>
<span>  author <span class="op">=</span> <span class="st">"Temesgen, Hailemariam and Monleon, Vicente J. and Hann, David W."</span>,</span>
<span>  journal <span class="op">=</span> <span class="st">"Canadian Journal of Forest Research"</span>,</span>
<span>  year <span class="op">=</span> <span class="fl">2008</span>,</span>
<span>  volume <span class="op">=</span> <span class="fl">38</span>,</span>
<span>  number <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  pages <span class="op">=</span> <span class="st">"553-565"</span>,</span>
<span>  year <span class="op">=</span> <span class="fl">2008</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>many different types of publications are available, called “entry
types”, and documentation for required fields are given <a href="https://www.bibtex.com/e/entry-types/" class="external-link">here</a>. The function that
creates a <code>Publication</code> requires two arguments, the citation
itself and an optional list of descriptors. The role of descriptors will
become clear as we progress. For now, just know that
<code>descriptors</code> is a named list of attributes that apply to
<em>all models</em> in the publication.</p>
<p>For example, all models in this publication are for Douglas-fir, and
were developed using data in the United States and Oregon. With this in
mind, we establish the <code>Publication</code> object.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temesgen_2008</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Publication.html">Publication</a></span><span class="op">(</span></span>
<span>  citation <span class="op">=</span> <span class="va">paper_citation</span>,</span>
<span>  descriptors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    country <span class="op">=</span> <span class="st">"US"</span>,</span>
<span>    region <span class="op">=</span> <span class="st">"US-OR"</span>,</span>
<span>    family <span class="op">=</span> <span class="st">"Pinaceae"</span>,</span>
<span>    genus <span class="op">=</span> <span class="st">"Pseudotsuga"</span>,</span>
<span>    species <span class="op">=</span> <span class="st">"menziesii"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><code>temesgen_2008</code> now represents a publication with citation
information and metadata that describe aspects of the models inside. One
problem, there are no models inside the publication yet, so we must add
them.</p>
</div>
<div class="section level2">
<h2 id="adding-a-single-model">Adding a Single Model<a class="anchor" aria-label="anchor" href="#adding-a-single-model"></a>
</h2>
<p>Models can be added one at a time. Other convenient ways of adding
models are described in the next section, but let us start with just one
model.</p>
<p>The publication we are using implements several <em>fixed effects
models</em> that predict the heights of trees using various covariates.
One of the functions the authors use is <span class="math inline">\(h =
1.37 + b_0 * (1 - \exp(b_1 * d)^{b_2})\)</span> where <span class="math inline">\(h\)</span> represents height and <span class="math inline">\(d\)</span> represents the diameter outside bark.
Note that the height is a function of the covariate <span class="math inline">\(d\)</span> and a finite set of parameters, <span class="math inline">\(b_0\)</span>, <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_2\)</span>. This is a perfect candidate for the
<code>FixedEffectsModel</code> class.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temesgen_2008_model_one</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FixedEffectsModel.html">FixedEffectsModel</a></span><span class="op">(</span></span>
<span>  response_unit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    hst <span class="op">=</span> <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/units/man/units.html" class="external-link">as_units</a></span><span class="op">(</span><span class="st">"m"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  covariate_units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    dsob <span class="op">=</span> <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/units/man/units.html" class="external-link">as_units</a></span><span class="op">(</span><span class="st">"cm"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    beta_0 <span class="op">=</span> <span class="fl">51.9954</span>,</span>
<span>    beta_1 <span class="op">=</span> <span class="op">-</span><span class="fl">0.0208</span>,</span>
<span>    beta_2 <span class="op">=</span> <span class="fl">1.0182</span></span>
<span>  <span class="op">)</span>,</span>
<span>  predict_fn <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">dsob</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fl">1.37</span> <span class="op">+</span> <span class="va">beta_0</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">beta_1</span> <span class="op">*</span> <span class="va">dsob</span><span class="op">)</span><span class="op">^</span><span class="va">beta_2</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can see that four arguments are used, <code>response_unit</code>,
<code>covariate_units</code>, <code>parameters</code> and
<code>predict_fn</code>.</p>
<ul>
<li>
<code>response_unit</code> - a named list containing one element,
which is the name of the response variable. In this case
<code>hst</code> indicates the model is the <strong>h</strong>eight of
the <strong>s</strong>tem using the <strong>t</strong>otal height. The
value of this element is established by providing the units using the
<code>units</code> package. In this case, the units are defined as
meters.</li>
<li>
<code>covariate_units</code> - a named list containing all
covariates usied in the model. In this case, only one covariate is used
called <code>dsob</code> which stands for the <strong>d</strong>iameter
of the <strong>s</strong>tem, <strong>o</strong>utside bark at
<strong>b</strong>reast height. Again, the units are defined, this time
as centimeters.</li>
<li>
<code>parameters</code> - a named list containing the parameters and
their estimates.</li>
<li>
<code>predict_fn</code> - this is the prediction function. Note that
the body of the function is written using the parameters and covariates,
but the only argument provided to the function is <code>dsob</code>,
i.e., the one covariate the model uses. This is for the author’s
convenience, and parameters are populated into the function at a later
phase, so they do not need to be defined as arguments to
<code>predict_fn</code>.</li>
</ul>
<p>Finally, we add the model to the publication using
<code>add_model</code></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temesgen_2008</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_model.html">add_model</a></span><span class="op">(</span><span class="va">temesgen_2008</span>, <span class="va">temesgen_2008_model_one</span><span class="op">)</span></span></code></pre></div>
<p>and print the summary for the publication</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temesgen_2008</span></span></code></pre></div>
<pre><code><span><span class="co">## Temesgen, Monleon, and Hann (2008)</span></span>
<span><span class="co">## --- hst: 1 model set</span></span>
<span><span class="co">## --------- 1 model</span></span></code></pre>
<p>We can see that the publciation now contains one model set for the
variable <code>hst</code> and that set contains one model.</p>
</div>
<div class="section level2">
<h2 id="adding-a-model-set">Adding a Model Set<a class="anchor" aria-label="anchor" href="#adding-a-model-set"></a>
</h2>
<p>A frequent pattern in allometric modeling papers are “model sets”,
these are sets of allometric models that have the same response,
covariate and functional structure, but are fit for several species, age
classes, etc. For example, Brackett (1977) fit 24 cubic volume functions
for different species disaggregated by geographic region and
species.</p>
<p><code>ModelSet</code> is a class in <code>allometric</code> that
efficiently deals with these types of model structures. For this example
we use <code>FixedEffectsSet</code> which represents a set of fixed
effects models. Model sets allow the author to import a table (e.g., a
<code>.csv</code>) of model descriptions to quickly define large sets of
<code>ParametricModel</code>s.</p>
<p>For this task, consider the Brackett (1977) publication. We begin
again defining the <code>Publication</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bracket_1977_citation</span> <span class="op">&lt;-</span> <span class="fu">RefManageR</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/RefManageR/reference/BibEntry.html" class="external-link">BibEntry</a></span><span class="op">(</span></span>
<span>  bibtype <span class="op">=</span> <span class="st">"techreport"</span>,</span>
<span>  key <span class="op">=</span> <span class="st">"brackett_1977"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Notes on tarif tree volume computation"</span>,</span>
<span>  author <span class="op">=</span> <span class="st">"Brackett, Michael"</span>,</span>
<span>  year <span class="op">=</span> <span class="fl">1977</span>,</span>
<span>  institution <span class="op">=</span> <span class="st">"State of Washington, Dept. of Natural Resources"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">brackett_1977</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Publication.html">Publication</a></span><span class="op">(</span></span>
<span>  citation <span class="op">=</span> <span class="va">bracket_1977_citation</span>,</span>
<span>  descriptors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    country <span class="op">=</span> <span class="st">"US"</span>,</span>
<span>    region <span class="op">=</span> <span class="st">"US-WA"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Here we can see the citation information and the shared descriptors.
Note that in this case, <code>descriptors</code> only contains
<code>country</code> and <code>region</code>. This is because each
individual model in <code>brackett_1977</code> is not uniform with
respect to <code>species</code> as it was in <code>temsegen_2008</code>,
so we will have to define those descriptors at the model-level.</p>
<p>Next, we load a data frame of model descriptions and examine it</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_specifications</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="fu">load_parameter_frame</span><span class="op">(</span><span class="st">"vsa_brackett_1977"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">model_specifications</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 8</span></span></span>
<span><span class="co">##   family   genus       species     geographic_region age_class     a     b     c</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Pinaceae Pseudotsuga menziesii   coastal           &lt; 140 ye… -<span style="color: #BB0000;">2.66</span>  1.74 1.13 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Pinaceae Pseudotsuga menziesii   coastal           &gt;= 80 ye… -<span style="color: #BB0000;">2.71</span>  1.66 1.20 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> Pinaceae Pseudotsuga menziesii   interior          <span style="color: #BB0000;">NA</span>        -<span style="color: #BB0000;">2.73</span>  1.74 1.17 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> Pinaceae Tsuga       heterophyl… coastal           &lt; 140 ye… -<span style="color: #BB0000;">2.70</span>  1.84 1.12 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> Pinaceae Tsuga       heterophyl… coastal           &gt;= 80 ye… -<span style="color: #BB0000;">2.66</span>  1.79 1.12 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> Pinaceae Tsuga       heterophyl… interior          <span style="color: #BB0000;">NA</span>        -<span style="color: #BB0000;">2.57</span>  1.97 0.977</span></span></code></pre>
<p>We can see that <code>model_specifications</code> contains a number
of individual models which are specified by column names referred to as
<code>descriptors</code>. In this case, <code>descriptors</code>
includes <code>family</code>, <code>genus</code>, <code>species</code>,
<code>geographic_region</code> and <code>age_class</code>. The
combination of these values uniquely identifies a model within this
publication. <code>family</code>, <code>genus</code> and
<code>species</code> are part of a standard set of descriptors called <a href="https://brycefrank.com/allometric/articles/descriptors.html" class="external-link">“search
descriptors”</a>, which get propagated to the searching functions
described in the README. <code>geographic_region</code> and
<code>age_class</code> are not search descriptors, but still help to
clarify the purpose of the model within the publication.</p>
<p>Next, we instantiate the <code>FixedEffectsSet</code>, which looks
very similar to <code>FixedEffectsModel</code> used in the previous
section. The arguments are the same, but the implication is that
<code>response unit</code>, <code>covariate units</code> and
<code>prediction_fn</code> all apply uniformly to the models in the
set.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brackett_1977_model_set</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FixedEffectsSet.html">FixedEffectsSet</a></span><span class="op">(</span></span>
<span>  response_unit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    vsa <span class="op">=</span> <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/units/man/units.html" class="external-link">as_units</a></span><span class="op">(</span><span class="st">"ft3"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  covariate_units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    dsob <span class="op">=</span> <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/units/man/units.html" class="external-link">as_units</a></span><span class="op">(</span><span class="st">"in"</span><span class="op">)</span>,</span>
<span>    hst  <span class="op">=</span> <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/units/man/units.html" class="external-link">as_units</a></span><span class="op">(</span><span class="st">"ft"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  parameter_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span>,</span>
<span>  predict_fn <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">dsob</span>, <span class="va">hst</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fl">10</span><span class="op">^</span><span class="va">a</span> <span class="op">*</span> <span class="va">dsob</span><span class="op">^</span><span class="va">b</span> <span class="op">*</span> <span class="va">hst</span><span class="op">^</span><span class="va">c</span></span>
<span>  <span class="op">}</span>,</span>
<span>  model_specifications <span class="op">=</span> <span class="va">model_specifications</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Finally, we add the model set to the publication using
<code>add_set</code> and print a summary to verify that the model was
added.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brackett_1977</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_set.html">add_set</a></span><span class="op">(</span><span class="va">brackett_1977</span>, <span class="va">brackett_1977_model_set</span><span class="op">)</span></span>
<span><span class="va">brackett_1977</span></span></code></pre></div>
<pre><code><span><span class="co">## Brackett (1977)</span></span>
<span><span class="co">## --- vsa: 1 model set</span></span>
<span><span class="co">## --------- 24 models</span></span></code></pre>
<p>This summary shows the publication name, followed by a list of all
model sets defined for the publication. We can see that there is 1 model
set for <code>vsa</code> (volume of the stem including top and stump)
that contains 24 models.</p>
</div>
<div class="section level2">
<h2 id="where-do-publications-go-from-here">Where do Publications go from here?<a class="anchor" aria-label="anchor" href="#where-do-publications-go-from-here"></a>
</h2>
<p>Once a publication and added models are located in a <code>.R</code>
file in the <code>inst/publications</code> the models contained within
can now be installed by the user using <code>install_models()</code>. In
fact, this is exactly how the user initially gains access to the
<code>allometric_models</code> table. If you are ever interested in
viewing the source code for a model, just find the matching
<code>.R</code> file in <code>inst/publications</code>, which can be
viewed locally or on GitHub. The files used for this example are located
at <a href="https://github.com/brycefrank/allometric/blob/master/inst/publications/temesgen_2008.R" class="external-link"><code>inst/publications/temesgen_2008.R</code></a>
and <a href="https://github.com/brycefrank/allometric/blob/master/inst/publications/brackett_1977.R" class="external-link"><code>inst/publications/brackett_1977.R</code></a>,
respectively.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Bryce Frank.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
